<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CoreMind - Download Resource</title>
  <style>
    :root {
      --bg: #0b0f1a;
      --card: #0f1629;
      --card-2: #121b33;
      --text: #e7f0ff;
      --muted: #9fb3d1;
      --accent: #5ee1a5;
      --accent-2: #6ea8fe;
      --ring: rgba(110, 168, 254, 0.5);
      --radius: 18px;
      --shadow: 0 10px 30px rgba(0, 12, 60, 0.35);
      --border: rgba(255,255,255,0.08);
    }

    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 32px; min-height: 100vh;
      font-family: 'Tajawal', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 400px at 80% -10%, rgba(110,168,254,0.08), transparent),
                  radial-gradient(600px 300px at 10% 110%, rgba(94,225,165,0.10), transparent),
                  var(--bg);
      color: var(--text);
      display: grid; place-items: center;
    }

    .download-card {
      width: min(900px, 92vw);
      min-height: 150px;
      display: grid;
      grid-template-columns: 140px 1fr auto;
      align-items: center;
      gap: 22px;
      padding: 22px 22px 22px 26px;
      border-radius: var(--radius);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0)) padding-box,
        linear-gradient(135deg, rgba(110,168,254,0.35), rgba(94,225,165,0.35)) border-box;
      border: 1px solid transparent;
      box-shadow: var(--shadow);
      position: relative;
      isolation: isolate;
      transition: transform .35s cubic-bezier(.2,.9,.2,1), filter .35s, box-shadow .35s;
    }

    .download-card::after {
      content: "";
      position: absolute; inset: -2px;
      border-radius: calc(var(--radius) + 2px);
      background: radial-gradient(500px 180px at 90% 10%, rgba(110,168,254,0.12), transparent),
                  radial-gradient(400px 150px at 0% 100%, rgba(94,225,165,0.10), transparent);
      z-index: -1;
      opacity: 0; transition: opacity .35s ease;
    }

    .download-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 18px 50px rgba(0, 12, 60, 0.45);
      filter: saturate(1.05);
    }
    .download-card:hover::after { opacity: 1; }

    .badge {
      justify-self: start;
      width: 120px; height: 120px;
      display: grid; place-items: center;
      background: radial-gradient(60% 60% at 50% 40%, rgba(110,168,254,0.15), transparent), var(--card);
      border-radius: 16px;
      border: 1px solid var(--border);
      position: relative; overflow: hidden;
    }
    .badge svg { width: 62px; height: 62px; }
    .badge .shine {
      position: absolute; inset: 0; pointer-events: none;
      background: linear-gradient(120deg, transparent 0 40%, rgba(255,255,255,.15) 50%, transparent 60% 100%);
      transform: translateX(-120%);
      transition: transform .8s ease;
    }
    .download-card:hover .badge .shine { transform: translateX(0%); }

    .content { align-self: center; }
    .top {
      display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
    }
    .title {
      font-size: 1.35rem; font-weight: 800; letter-spacing: .2px;
    }
    .version {
      padding: 6px 10px; border-radius: 999px;
      font-size: .85rem; color: #0a1426; font-weight: 700;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: 0 6px 16px rgba(110,168,254,0.35);
    }
    .desc { margin: 8px 0 12px; color: var(--muted); line-height: 1.6; }
    .meta { font-size: .9rem; color: #c9d7f0; opacity: .85; }
    .meta .size { font-feature-settings: "tnum"; }

    .cta {
      align-self: stretch;
      display: grid; place-items: center;
    }
    .btn {
      appearance: none; cursor: pointer;
      text-decoration: none; color: #0a1426; font-weight: 800; letter-spacing: .3px;
      padding: 14px 22px; border-radius: 14px; border: 0;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: 0 10px 20px rgba(110,168,254,0.35);
      display: inline-flex; align-items: center; gap: 10px;
      transform: translateZ(0);
      transition: transform .25s ease, box-shadow .25s ease, filter .25s ease;
    }
    .btn svg { width: 20px; height: 20px; }
    .btn:hover { transform: translateY(-2px); filter: saturate(1.08); box-shadow: 0 14px 26px rgba(110,168,254,0.45); }
    .btn:active { transform: translateY(0); box-shadow: 0 8px 12px rgba(110,168,254,0.3); }

    .download-card:hover .btn .arrow { transform: translateX(-2px); }
    .arrow { transition: transform .35s ease; }

    .mirrors {
      margin-top: 10px; font-size: .9rem;
    }
    .mirrors a {
      color: #b9d3ff; text-decoration: underline dotted; margin-inline-start: 8px;
    }

    @media (max-width: 720px) {
      .download-card { grid-template-columns: 110px 1fr; }
      .cta { grid-column: 1 / -1; justify-self: start; }
    }

    @media (prefers-reduced-motion: reduce) {
      .download-card, .btn, .arrow, .badge .shine { transition: none !important; }
    }
  </style>
</head>
<body>

  <article class="download-card" aria-label="بطاقة تحميل المود">
    <div class="badge" aria-hidden="true">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
        <path d="M12 3v12" />
        <path d="M7 11l5 5 5-5" />
        <rect x="3" y="17" width="18" height="4" rx="1.5" />
      </svg>
      <span class="shine"></span>
    </div>

    <div class="content">
      <div class="top">
        <h3 class="title">تحميل المود</h3>
        <span id="version" class="version" title="الإصدار">جارٍ التحميل...</span>
      </div>
      <p class="desc">نسخة محسّنة مع إصلاحات واستقرار أعلى. يدعم أحدث التحديثات ويعمل على جميع الإصدارات المتوافقة.</p>
      <div id="meta" class="meta">
        <span class="size">الحجم: …</span> • <span class="updated">آخر تحديث: …</span>
      </div>
    </div>

    <div class="cta">
      <a id="downloadBtn" class="btn" href="#" download>
        تنزيل الآن
        <svg class="arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 12H4" />
          <path d="M10 8l4 4-4 4" />
        </svg>
      </a>
      <div class="mirrors">
        مرايا التحميل:
        <a id="mirror1" href="#" download>رابط 1 (Raw)</a> /
        <a id="mirror2" href="#" download>رابط 2 (Pages)</a>
      </div>
    </div>
  </article>

  <script>
    // روابط التحميل
    const PRIMARY_URL = "https://raw.githubusercontent.com/vndel/pages/main/coremind.zip";
    const MIRROR_URL  = "http://vndel.github.io/pages/coremind.zip";
    const VERSION_JSON = "https://raw.githubusercontent.com/vndel/pages/main/coremind_version.json";

    const versionEl   = document.getElementById("version");
    const metaEl      = document.getElementById("meta");
    const sizeEl      = metaEl.querySelector(".size");
    const updatedEl   = metaEl.querySelector(".updated");
    const downloadBtn = document.getElementById("downloadBtn");
    const mirror1     = document.getElementById("mirror1");
    const mirror2     = document.getElementById("mirror2");

    // تهيئة روابط الأزرار
    downloadBtn.href = PRIMARY_URL;   // الأساسي
    mirror1.href     = PRIMARY_URL;   // مرآة 1
    mirror2.href     = MIRROR_URL;    // مرآة 2

    // تنسيق الحجم إلى صيغة بشرية
    function formatBytes(bytes) {
      if (!Number.isFinite(bytes) || bytes <= 0) return "غير معروف";
      const units = ["B","KB","MB","GB","TB"];
      const i = Math.floor(Math.log(bytes) / Math.log(1024));
      const value = bytes / Math.pow(1024, i);
      return `${value.toFixed(value >= 100 ? 0 : value >= 10 ? 1 : 2)} ${units[i]}`;
    }

    // محاولة جلب الحجم عبر HEAD ثم Fallback إلى Range GET
    async function getFileSize(url) {
      try {
        // 1) HEAD
        const head = await fetch(url, { method: "HEAD" });
        if (head.ok) {
          const len = head.headers.get("content-length");
          if (len) return parseInt(len, 10);
        }
      } catch (e) {
        // تجاهل ونجرّب الخطة ب
      }
      try {
        // 2) GET برينج صغير لاستخراج Content-Range إن توفر
        const res = await fetch(url, { headers: { Range: "bytes=0-0" } });
        if (res.ok) {
          const len = res.headers.get("content-length");
          const range = res.headers.get("content-range"); // شكلها: bytes 0-0/123456
          if (range && range.includes("/")) {
            const total = range.split("/")[1];
            const totalNum = parseInt(total, 10);
            if (Number.isFinite(totalNum)) return totalNum;
          }
          if (len) return parseInt(len, 10);
        }
      } catch (e) {
        // no-op
      }
      return null;
    }

    // تحديث الحجم بعرض أول نتيجة ناجحة (أو الأفضلية للرابط الأساسي)
    async function updateFileSize() {
      const primarySize = await getFileSize(PRIMARY_URL);
      if (primarySize) {
        sizeEl.textContent = "الحجم: " + formatBytes(primarySize);
        return;
      }
      const mirrorSize = await getFileSize(MIRROR_URL);
      if (mirrorSize) {
        sizeEl.textContent = "الحجم: " + formatBytes(mirrorSize);
        return;
      }
      sizeEl.textContent = "الحجم: غير معروف";
    }

    // قراءة الإصدار وآخر تحديث (إن وُجد)
    async function updateVersionAndDate() {
      try {
        const res = await fetch(VERSION_JSON);
        if (!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();

        if (data.version) {
          versionEl.textContent = "v" + String(data.version).trim();
        } else {
          versionEl.textContent = "غير متوفر";
        }

        if (data.lastUpdate) {
          // لو بصيغة ISO نحاول تنسيقها؛ غير ذلك نعرضها كما هي
          const text = String(data.lastUpdate).trim();
          const isoMatch = text.match(/^(\d{4})-(\d{2})-(\d{2})/);
          if (isoMatch) {
            const d = new Date(text);
            // تنسيق عربي بسيط: 16 أغسطس 2025
            const months = ["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"];
            const day = d.getDate();
            const month = months[d.getMonth()];
            const year = d.getFullYear();
            updatedEl.textContent = "آخر تحديث: " + `${day} ${month} ${year}`;
          } else {
            updatedEl.textContent = "آخر تحديث: " + text;
          }
        } else {
          updatedEl.textContent = "آخر تحديث: غير متوفر";
        }
      } catch (err) {
        console.error("خطأ في جلب الإصدار/التاريخ:", err);
        versionEl.textContent = "خطأ";
        // لا نغيّر updatedEl هنا، نخليه على قيمته الحالية
      }
    }

    // تشغيل التحديثات
    updateVersionAndDate();
    updateFileSize();
  </script>

</body>
</html>
