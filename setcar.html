<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SetCar → عنصر جاهز للنسخ</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#0f1730;
      --muted:#9aa7c7;
      --text:#eaf0ff;
      --line:rgba(255,255,255,.10);
      --accent:#7c5cff;
      --accent2:#32d7c6;
      --danger:#ff4d6d;
      --ok:#35d07f;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Arabic", "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(1200px 700px at 10% 5%, rgba(124,92,255,.25), transparent 60%),
        radial-gradient(900px 600px at 90% 20%, rgba(50,215,198,.18), transparent 60%),
        radial-gradient(900px 600px at 50% 110%, rgba(255,77,109,.10), transparent 60%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .wrap{
      width:min(980px, 100%);
      display:grid;
      gap:18px;
    }

    .header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      padding:18px 20px;
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .header::after{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(500px 120px at 15% 10%, rgba(124,92,255,.22), transparent 60%),
        radial-gradient(500px 120px at 80% 30%, rgba(50,215,198,.18), transparent 60%);
      pointer-events:none;
      filter:blur(2px);
      opacity:.9;
    }
    .header > *{position:relative; z-index:1}
    .title{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    h1{
      margin:0;
      font-size:20px;
      letter-spacing:.2px;
    }
    .sub{
      color:var(--muted);
      font-size:13px;
      line-height:1.6;
    }

    .pill{
      display:flex;
      gap:10px;
      align-items:center;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:999px;
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background:linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow:0 0 0 3px rgba(124,92,255,.15);
    }

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:18px;
    }

    @media (max-width: 860px){
      .grid{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .cardHead{
      padding:14px 16px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,0));
    }
    .cardHead .label{
      font-weight:600;
      font-size:14px;
    }
    .cardHead .hint{
      color:var(--muted);
      font-size:12px;
    }

    .cardBody{padding:16px}

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-bottom:12px;
    }
    @media (max-width: 520px){
      .row{grid-template-columns:1fr}
    }

    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:6px;
    }
    input, textarea{
      width:100%;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      color:var(--text);
      border-radius:14px;
      padding:12px 12px;
      outline:none;
      transition:.2s;
      font-size:14px;
    }
    textarea{
      min-height:92px;
      resize:vertical;
      font-family:var(--mono);
      direction:ltr; /* للـ command */
    }
    input:focus, textarea:focus{
      border-color: rgba(124,92,255,.65);
      box-shadow: 0 0 0 4px rgba(124,92,255,.15);
    }
    .mono{
      font-family:var(--mono);
      direction:ltr;
    }

    .btns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    button{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      transition:.2s;
      font-weight:600;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    button:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.22);
      background:rgba(255,255,255,.06);
    }
    button.primary{
      border-color: rgba(124,92,255,.55);
      background: linear-gradient(180deg, rgba(124,92,255,.28), rgba(124,92,255,.12));
    }
    button.primary:hover{
      border-color: rgba(124,92,255,.75);
      box-shadow: 0 10px 30px rgba(124,92,255,.12);
    }
    button.good{
      border-color: rgba(53,208,127,.55);
      background: linear-gradient(180deg, rgba(53,208,127,.22), rgba(53,208,127,.10));
    }
    button.bad{
      border-color: rgba(255,77,109,.55);
      background: linear-gradient(180deg, rgba(255,77,109,.20), rgba(255,77,109,.10));
    }

    .out{
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding: 14px;
      font-family: var(--mono);
      direction:ltr;
      white-space: pre-wrap;
      word-break: break-word;
      line-height:1.6;
      min-height: 120px;
    }

    .toast{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .toast .state{
      width:10px;height:10px;border-radius:50%;
      background:rgba(255,255,255,.18);
    }
    .toast.ok .state{background:var(--ok)}
    .toast.err .state{background:var(--danger)}
    .toast span{opacity:.95}
    .small{
      font-size:12px;
      color:var(--muted);
      line-height:1.6;
      margin-top:10px;
    }

    .switch{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
    }
    .switch input{
      width:auto;
      transform: translateY(1px);
      accent-color: var(--accent);
    }
    code.k{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      padding: 2px 6px;
      border-radius: 10px;
      font-family: var(--mono);
      font-size: 12px;
      direction:ltr;
      display:inline-block;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="title">
        <h1>محوّل setcar → عنصر جاهز للنسخ</h1>
        <div class="sub">
          اكتب القيم أو الصق الأمر <code class="k">setcar "..." "..." "..." "..." "..."</code> وسيطلع لك نفس الشكل:
          <code class="k">{displayName = "...", spawnName = "...", price = 0, level = 0, category = 0},</code>
        </div>
      </div>
      <div class="pill" title="جاهز للنسخ بضغطة">
        <div class="dot"></div>
        نسخ مباشر
      </div>
    </div>

    <div class="grid">
      <!-- Left: Inputs -->
      <div class="card">
        <div class="cardHead">
          <div>
            <div class="label">المدخلات</div>
            <div class="hint">اكتب يدويًا أو استخدم لصق الأمر</div>
          </div>
        </div>
        <div class="cardBody">
          <div class="row">
            <div>
              <label for="displayName">displayName (اسم العرض)</label>
              <input id="displayName" placeholder='مثال: اكورد 2017' />
            </div>
            <div>
              <label for="spawnName">spawnName</label>
              <input id="spawnName" class="mono" placeholder='مثال: relax902' />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="price">price</label>
              <input id="price" class="mono" inputmode="numeric" placeholder="150000" />
            </div>
            <div>
              <label for="level">level</label>
              <input id="level" class="mono" inputmode="numeric" placeholder="10" />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="category">category</label>
              <input id="category" class="mono" inputmode="numeric" placeholder="5" />
            </div>
            <div>
              <label for="cmd">أو الصق أمر setcar هنا</label>
              <textarea id="cmd" spellcheck="false" placeholder='setcar "اكورد 2017" "relax902" "150000" "10" "5"'></textarea>
            </div>
          </div>

          <div class="switch">
            <label style="margin:0; display:flex; align-items:center; gap:8px;">
              <input type="checkbox" id="asJson" />
              طلّع JSON صحيح (بدل صيغة =)
            </label>
            <label style="margin:0; display:flex; align-items:center; gap:8px;">
              <input type="checkbox" id="trailComma" checked />
              أضف فاصلة آخر السطر <code class="k">,</code>
            </label>
          </div>

          <div class="btns">
            <button class="primary" id="btnParse">استخرج من الأمر</button>
            <button id="btnClear" class="bad">تفريغ</button>
          </div>

          <div class="small">
            ملاحظة: لو كتبت بالحقول فوق، النتيجة تتحدث تلقائيًا. ولو لصقت أمر setcar، اضغط “استخرج”.
          </div>
        </div>
      </div>

      <!-- Right: Output -->
      <div class="card">
        <div class="cardHead">
          <div>
            <div class="label">الناتج</div>
            <div class="hint">انسخه مباشرة</div>
          </div>
        </div>
        <div class="cardBody">
          <div id="out" class="out">{displayName = "", spawnName = "", price = 0, level = 0, category = 0},</div>

          <div class="btns" style="margin-top:12px;">
            <button class="good" id="btnCopy">نسخ</button>
            <button id="btnCopyOneLine">نسخ سطر واحد</button>
          </div>

          <div id="toast" class="toast">
            <div class="state"></div>
            <span>جاهز.</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const els = {
      displayName: document.getElementById('displayName'),
      spawnName: document.getElementById('spawnName'),
      price: document.getElementById('price'),
      level: document.getElementById('level'),
      category: document.getElementById('category'),
      cmd: document.getElementById('cmd'),
      asJson: document.getElementById('asJson'),
      trailComma: document.getElementById('trailComma'),
      out: document.getElementById('out'),
      toast: document.getElementById('toast'),
      btnCopy: document.getElementById('btnCopy'),
      btnCopyOneLine: document.getElementById('btnCopyOneLine'),
      btnParse: document.getElementById('btnParse'),
      btnClear: document.getElementById('btnClear'),
    };

    function setToast(type, msg){
      els.toast.classList.remove('ok','err');
      if(type) els.toast.classList.add(type);
      els.toast.querySelector('span').textContent = msg;
      // reset after a bit
      clearTimeout(setToast._t);
      setToast._t = setTimeout(() => {
        els.toast.classList.remove('ok','err');
        els.toast.querySelector('span').textContent = 'جاهز.';
      }, 2200);
    }

    function toIntOrZero(v){
      const n = Number(String(v).trim());
      return Number.isFinite(n) ? Math.trunc(n) : 0;
    }

    function escapeQuotes(s){
      return String(s ?? '').replace(/\\/g,'\\\\').replace(/"/g,'\\"');
    }

    function buildOutput(oneLine=false){
      const dn = (els.displayName.value ?? '').trim();
      const sn = (els.spawnName.value ?? '').trim();
      const price = toIntOrZero(els.price.value);
      const level = toIntOrZero(els.level.value);
      const category = toIntOrZero(els.category.value);
      const comma = els.trailComma.checked ? ',' : '';

      let txt = '';

      if(els.asJson.checked){
        // JSON صحيح
        const obj = {
          displayName: dn,
          spawnName: sn,
          price,
          level,
          category
        };
        txt = JSON.stringify(obj, null, oneLine ? 0 : 2) + comma;
      }else{
        // نفس الصيغة اللي عطيتها (=)
        const parts = [
          `displayName = "${escapeQuotes(dn)}"`,
          `spawnName = "${escapeQuotes(sn)}"`,
          `price = ${price}`,
          `level = ${level}`,
          `category = ${category}`,
        ];
        if(oneLine){
          txt = `{${parts.join(', ')}}${comma}`;
        }else{
          // شكل مرتب شبيه بمثال المستخدم
          txt = `{${parts.join(', ')}}${comma}`;
        }
      }

      els.out.textContent = txt;
      return txt;
    }

    function parseSetCarCommand(cmd){
      // يدعم: setcar "a" "b" "150000" "10" "5"
      // ويقبل مسافات كثيرة + اقتباسات مزدوجة.
      const text = String(cmd ?? '').trim();
      if(!text) return null;

      // التقط كل النصوص داخل "..."
      const quoted = [...text.matchAll(/"([^"]*)"/g)].map(m => m[1]);

      // بديل: لو أرقام بدون اقتباس (نادر)
      // لكن طلبك واضح أن الكل داخل اقتباس، فنبقى على quoted.
      if(quoted.length < 5) return null;

      return {
        displayName: quoted[0],
        spawnName: quoted[1],
        price: quoted[2],
        level: quoted[3],
        category: quoted[4],
      };
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        setToast('ok', 'تم النسخ ✅');
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.opacity = '0';
        document.body.appendChild(ta);
        ta.select();
        try{
          document.execCommand('copy');
          setToast('ok', 'تم النسخ ✅');
        }catch(err){
          setToast('err', 'فشل النسخ. انسخ يدويًا.');
        }finally{
          document.body.removeChild(ta);
        }
      }
    }

    function clearAll(){
      els.displayName.value = '';
      els.spawnName.value = '';
      els.price.value = '';
      els.level.value = '';
      els.category.value = '';
      els.cmd.value = '';
      els.asJson.checked = false;
      els.trailComma.checked = true;
      buildOutput(false);
      setToast(null, 'تم التفريغ.');
    }

    // Live update when typing in fields
    ['input','change'].forEach(ev=>{
      [els.displayName, els.spawnName, els.price, els.level, els.category, els.asJson, els.trailComma]
        .forEach(el => el.addEventListener(ev, () => buildOutput(false)));
    });

    els.btnParse.addEventListener('click', () => {
      const parsed = parseSetCarCommand(els.cmd.value);
      if(!parsed){
        setToast('err', 'ما قدرت أفهم الأمر. تأكد أنه مثل: setcar "a" "b" "150000" "10" "5"');
        return;
      }
      els.displayName.value = parsed.displayName;
      els.spawnName.value = parsed.spawnName;
      els.price.value = parsed.price;
      els.level.value = parsed.level;
      els.category.value = parsed.category;
      buildOutput(false);
      setToast('ok', 'تم استخراج القيم من الأمر.');
    });

    els.btnCopy.addEventListener('click', () => copyText(buildOutput(false)));
    els.btnCopyOneLine.addEventListener('click', () => copyText(buildOutput(true)));
    els.btnClear.addEventListener('click', clearAll);

    // Init
    buildOutput(false);
  </script>
</body>
</html>
